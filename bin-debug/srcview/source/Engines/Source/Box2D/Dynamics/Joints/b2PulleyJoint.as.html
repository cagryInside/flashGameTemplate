<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>b2PulleyJoint.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/*
* Copyright (c) 2006-2007 Erin Catto http://www.gphysics.com
*
* This software is provided 'as-is', without any express or implied
* warranty.  In no event will the authors be held liable for any damages
* arising from the use of this software.
* Permission is granted to anyone to use this software for any purpose,
* including commercial applications, and to alter it and redistribute it
* freely, subject to the following restrictions:
* 1. The origin of this software must not be misrepresented; you must not
* claim that you wrote the original software. If you use this software
* in a product, an acknowledgment in the product documentation would be
* appreciated but is not required.
* 2. Altered source versions must be plainly marked as such, and must not be
* misrepresented as being the original software.
* 3. This notice may not be removed or altered from any source distribution.
*/</span>

<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dynamics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Joints</span><span class="ActionScriptBracket/Brace">{</span>
    
    
    
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dynamics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;

<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2internal</span>;
<span class="ActionScriptReserved">use</span> <span class="ActionScriptReserved">namespace</span> <span class="ActionScriptDefault_Text">b2internal</span>;

    
<span class="ActionScriptASDoc">/**
* The pulley joint is connected to two bodies and two fixed ground points.
* The pulley supports a ratio such that:
* length1 + ratio * length2 &lt;= constant
* Yes, the force transmitted is scaled by the ratio.
* The pulley also enforces a maximum length limit on both sides. This is
* useful to prevent one side of the pulley hitting the top.
* @see b2PulleyJointDef
*/</span>
<span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">b2PulleyJoint</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">b2Joint</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptASDoc">/** @inheritDoc */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetAnchorA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetWorldPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptASDoc">/** @inheritDoc */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetAnchorB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetWorldPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/** @inheritDoc */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetReactionForce</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inv_dt</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span> :<span class="ActionScriptDefault_Text">b2Vec2</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//b2Vec2 P = m_impulse * m_u2;
</span>        <span class="ActionScriptComment">//return inv_dt * P;
</span>        <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inv_dt</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">inv_dt</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/** @inheritDoc */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetReactionTorque</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inv_dt</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span> :<span class="ActionScriptDefault_Text">Number</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//B2_NOT_USED(inv_dt);
</span>        <span class="ActionScriptReserved">return</span> 0.0;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Get the first ground anchor.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetGroundAnchorA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> :<span class="ActionScriptDefault_Text">b2Vec2</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//return m_ground.m_xf.position + m_groundAnchor1;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">a</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Copy</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">a</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Add</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">a</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Get the second ground anchor.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetGroundAnchorB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> :<span class="ActionScriptDefault_Text">b2Vec2</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//return m_ground.m_xf.position + m_groundAnchor2;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">a</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Copy</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">a</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Add</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">a</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Get the current length of the segment attached to body1.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetLength1</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> :<span class="ActionScriptDefault_Text">Number</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetWorldPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">//b2Vec2 s = m_ground-&gt;m_xf.position + m_groundAnchor1;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptComment">//b2Vec2 d = p - s;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">sX</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">sY</span>;
        <span class="ActionScriptComment">//return d.Length();
</span>        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dX</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">dX</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">dY</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">dY</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Get the current length of the segment attached to body2.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetLength2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> :<span class="ActionScriptDefault_Text">Number</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetWorldPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">//b2Vec2 s = m_ground-&gt;m_xf.position + m_groundAnchor2;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptComment">//b2Vec2 d = p - s;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">sX</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">sY</span>;
        <span class="ActionScriptComment">//return d.Length();
</span>        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dX</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">dX</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">dY</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">dY</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Get the pulley ratio.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetRatio</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_ratio</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptComment">//--------------- Internals Below -------------------
</span>
    <span class="ActionScriptASDoc">/** @private */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">b2PulleyJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span>:<span class="ActionScriptDefault_Text">b2PulleyJointDef</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptComment">// parent
</span>        <span class="ActionScriptReserved">super</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tMat</span>:<span class="ActionScriptDefault_Text">b2Mat22</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tX</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tY</span>:<span class="ActionScriptDefault_Text">Number</span>;
        
        <span class="ActionScriptDefault_Text">m_ground</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_world</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_groundBody</span>;
        <span class="ActionScriptComment">//m_groundAnchor1 = def-&gt;groundAnchorA - m_ground-&gt;m_xf.position;
</span>        <span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">groundAnchorA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">groundAnchorA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptComment">//m_groundAnchor2 = def-&gt;groundAnchorB - m_ground-&gt;m_xf.position;
</span>        <span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">groundAnchorB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">groundAnchorB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptComment">//m_localAnchor1 = def-&gt;localAnchorA;
</span>        <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetV</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localAnchorA</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">//m_localAnchor2 = def-&gt;localAnchorB;
</span>        <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetV</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localAnchorB</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">//b2Settings.b2Assert(def.ratio != 0.0);
</span>        <span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ratio</span>;
        
        <span class="ActionScriptDefault_Text">m_constant</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lengthA</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lengthB</span>;
        
        <span class="ActionScriptDefault_Text">m_maxLength1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Min</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">maxLengthA</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_constant</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">b2_minPulleyLength</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">m_maxLength2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Min</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">maxLengthB</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_constant</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">b2_minPulleyLength</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">m_ratio</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptDefault_Text">m_limitImpulse1</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptDefault_Text">m_limitImpulse2</span> <span class="ActionScriptOperator">=</span> 0.0;
        
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">InitVelocityConstraints</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span>:<span class="ActionScriptDefault_Text">b2TimeStep</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bA</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyA</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bB</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyB</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tMat</span>:<span class="ActionScriptDefault_Text">b2Mat22</span>;
        
        <span class="ActionScriptComment">//b2Vec2 r1 = b2Mul(bA-&gt;m_xf.R, m_localAnchor1 - bA-&gt;GetLocalCenter());
</span>        <span class="ActionScriptDefault_Text">tMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r1X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r1Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tX</span>;
        <span class="ActionScriptComment">//b2Vec2 r2 = b2Mul(bB-&gt;m_xf.R, m_localAnchor2 - bB-&gt;GetLocalCenter());
</span>        <span class="ActionScriptDefault_Text">tMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r2X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r2Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptDefault_Text">tX</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tX</span>;
        
        <span class="ActionScriptComment">//b2Vec2 p1 = bA-&gt;m_sweep.c + r1;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p1X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r1X</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p1Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r1Y</span>;
        <span class="ActionScriptComment">//b2Vec2 p2 = bB-&gt;m_sweep.c + r2;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p2X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r2X</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p2Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r2Y</span>;
        
        <span class="ActionScriptComment">//b2Vec2 s1 = m_ground-&gt;m_xf.position + m_groundAnchor1;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s1X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s1Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptComment">//b2Vec2 s2 = m_ground-&gt;m_xf.position + m_groundAnchor2;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s2X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s2Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        
        <span class="ActionScriptComment">// Get the pulley axes.
</span>        <span class="ActionScriptComment">//m_u1 = p1 - s1;
</span>        <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p1X</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s1X</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s1Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">//m_u2 = p2 - s2;
</span>        <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p2X</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s2X</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s2Y</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">length1</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">length2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//m_u1 *= 1.0f / length1;
</span>            <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Multiply</span><span class="ActionScriptBracket/Brace">(</span>1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">length1</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetZero</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length2</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//m_u2 *= 1.0f / length2;
</span>            <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Multiply</span><span class="ActionScriptBracket/Brace">(</span>1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">length2</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetZero</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">C</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_constant</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">length2</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">&gt;</span> 0.0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_state</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e_inactiveLimit</span>;
            <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_state</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">m_maxLength1</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_limitState1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e_inactiveLimit</span>;
            <span class="ActionScriptDefault_Text">m_limitImpulse1</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_limitState1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length2</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">m_maxLength2</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_limitState2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e_inactiveLimit</span>;
            <span class="ActionScriptDefault_Text">m_limitImpulse2</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_limitState2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Compute effective mass.
</span>        <span class="ActionScriptComment">//var cr1u1:Number = b2Cross(r1, m_u1);
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cr1u1</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptComment">//var cr2u2:Number = b2Cross(r2, m_u2);
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cr2u2</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        
        <span class="ActionScriptDefault_Text">m_limitMass1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">cr1u1</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">cr1u1</span>;
        <span class="ActionScriptDefault_Text">m_limitMass2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">cr2u2</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">cr2u2</span>;
        <span class="ActionScriptDefault_Text">m_pulleyMass</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_limitMass1</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_limitMass2</span>;
        <span class="ActionScriptComment">//b2Settings.b2Assert(m_limitMass1 &gt; Number.MIN_VALUE);
</span>        <span class="ActionScriptComment">//b2Settings.b2Assert(m_limitMass2 &gt; Number.MIN_VALUE);
</span>        <span class="ActionScriptComment">//b2Settings.b2Assert(m_pulleyMass &gt; Number.MIN_VALUE);
</span>        <span class="ActionScriptDefault_Text">m_limitMass1</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">m_limitMass1</span>;
        <span class="ActionScriptDefault_Text">m_limitMass2</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">m_limitMass2</span>;
        <span class="ActionScriptDefault_Text">m_pulleyMass</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">m_pulleyMass</span>;
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">warmStarting</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Scale impulses to support variable time steps.
</span>            <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dtRatio</span>;
            <span class="ActionScriptDefault_Text">m_limitImpulse1</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dtRatio</span>;
            <span class="ActionScriptDefault_Text">m_limitImpulse2</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dtRatio</span>;
            
            <span class="ActionScriptComment">// Warm starting.
</span>            <span class="ActionScriptComment">//b2Vec2 P1 = (-m_impulse - m_limitImpulse1) * m_u1;
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P1X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_limitImpulse1</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P1Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_limitImpulse1</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptComment">//b2Vec2 P2 = (-m_ratio * m_impulse - m_limitImpulse2) * m_u2;
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P2X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_limitImpulse2</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P2Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_limitImpulse2</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptComment">//bA.m_linearVelocity += bA.m_invMass * P1;
</span>            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1X</span>;
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1Y</span>;
            <span class="ActionScriptComment">//bA.m_angularVelocity += bA.m_invI * b2Cross(r1, P1);
</span>            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1X</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//bB.m_linearVelocity += bB.m_invMass * P2;
</span>            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2X</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2Y</span>;
            <span class="ActionScriptComment">//bB.m_angularVelocity += bB.m_invI * b2Cross(r2, P2);
</span>            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2X</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">=</span> 0.0;
            <span class="ActionScriptDefault_Text">m_limitImpulse1</span> <span class="ActionScriptOperator">=</span> 0.0;
            <span class="ActionScriptDefault_Text">m_limitImpulse2</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SolveVelocityConstraints</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span>:<span class="ActionScriptDefault_Text">b2TimeStep</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span> 
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//B2_NOT_USED(step)
</span>        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bA</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyA</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bB</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyB</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tMat</span>:<span class="ActionScriptDefault_Text">b2Mat22</span>;
        
        <span class="ActionScriptComment">//b2Vec2 r1 = b2Mul(bA-&gt;m_xf.R, m_localAnchor1 - bA-&gt;GetLocalCenter());
</span>        <span class="ActionScriptDefault_Text">tMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r1X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r1Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tX</span>;
        <span class="ActionScriptComment">//b2Vec2 r2 = b2Mul(bB-&gt;m_xf.R, m_localAnchor2 - bB-&gt;GetLocalCenter());
</span>        <span class="ActionScriptDefault_Text">tMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r2X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r2Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptDefault_Text">tX</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tX</span>;
        
        <span class="ActionScriptComment">// temp vars
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v1X</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v1Y</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v2X</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v2Y</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P1X</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P1Y</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P2X</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">P2Y</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Cdot</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">impulse</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldImpulse</span>:<span class="ActionScriptDefault_Text">Number</span>;
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_state</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//b2Vec2 v1 = bA-&gt;m_linearVelocity + b2Cross(bA-&gt;m_angularVelocity, r1);
</span>            <span class="ActionScriptDefault_Text">v1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">v1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//b2Vec2 v2 = bB-&gt;m_linearVelocity + b2Cross(bB-&gt;m_angularVelocity, r2);
</span>            <span class="ActionScriptDefault_Text">v2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">v2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//Cdot = -b2Dot(m_u1, v1) - m_ratio * b2Dot(m_u2, v2);
</span>            <span class="ActionScriptDefault_Text">Cdot</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">v1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">v1Y</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">v2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">v2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_pulleyMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">Cdot</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">oldImpulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_impulse</span>;
            <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Max</span><span class="ActionScriptBracket/Brace">(</span>0.0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">impulse</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_impulse</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">oldImpulse</span>;
            
            <span class="ActionScriptComment">//b2Vec2 P1 = -impulse * m_u1;
</span>            <span class="ActionScriptDefault_Text">P1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">P1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptComment">//b2Vec2 P2 = - m_ratio * impulse * m_u2;
</span>            <span class="ActionScriptDefault_Text">P2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">P2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptComment">//bA.m_linearVelocity += bA.m_invMass * P1;
</span>            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1X</span>;
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1Y</span>;
            <span class="ActionScriptComment">//bA.m_angularVelocity += bA.m_invI * b2Cross(r1, P1);
</span>            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1X</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//bB.m_linearVelocity += bB.m_invMass * P2;
</span>            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2X</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2Y</span>;
            <span class="ActionScriptComment">//bB.m_angularVelocity += bB.m_invI * b2Cross(r2, P2);
</span>            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2X</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_limitState1</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//b2Vec2 v1 = bA-&gt;m_linearVelocity + b2Cross(bA-&gt;m_angularVelocity, r1);
</span>            <span class="ActionScriptDefault_Text">v1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">v1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//float32 Cdot = -b2Dot(m_u1, v1);
</span>            <span class="ActionScriptDefault_Text">Cdot</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">v1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">v1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_limitMass1</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Cdot</span>;
            <span class="ActionScriptDefault_Text">oldImpulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_limitImpulse1</span>;
            <span class="ActionScriptDefault_Text">m_limitImpulse1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Max</span><span class="ActionScriptBracket/Brace">(</span>0.0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_limitImpulse1</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">impulse</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_limitImpulse1</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">oldImpulse</span>;
            
            <span class="ActionScriptComment">//b2Vec2 P1 = -impulse * m_u1;
</span>            <span class="ActionScriptDefault_Text">P1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">P1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptComment">//bA.m_linearVelocity += bA-&gt;m_invMass * P1;
</span>            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1X</span>;
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1Y</span>;
            <span class="ActionScriptComment">//bA.m_angularVelocity += bA-&gt;m_invI * b2Cross(r1, P1);
</span>            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P1X</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_limitState2</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//b2Vec2 v2 = bB-&gt;m_linearVelocity + b2Cross(bB-&gt;m_angularVelocity, r2);
</span>            <span class="ActionScriptDefault_Text">v2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">v2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//float32 Cdot = -b2Dot(m_u2, v2);
</span>            <span class="ActionScriptDefault_Text">Cdot</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">v2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">v2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_limitMass2</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Cdot</span>;
            <span class="ActionScriptDefault_Text">oldImpulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_limitImpulse2</span>;
            <span class="ActionScriptDefault_Text">m_limitImpulse2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Max</span><span class="ActionScriptBracket/Brace">(</span>0.0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_limitImpulse2</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">impulse</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_limitImpulse2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">oldImpulse</span>;
            
            <span class="ActionScriptComment">//b2Vec2 P2 = -impulse * m_u2;
</span>            <span class="ActionScriptDefault_Text">P2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">P2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptComment">//bB-&gt;m_linearVelocity += bB-&gt;m_invMass * P2;
</span>            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2X</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_linearVelocity</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2Y</span>;
            <span class="ActionScriptComment">//bB-&gt;m_angularVelocity += bB-&gt;m_invI * b2Cross(r2, P2);
</span>            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_angularVelocity</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">P2X</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SolvePositionConstraints</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">baumgarte</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span> 
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//B2_NOT_USED(baumgarte)
</span>        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bA</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyA</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bB</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyB</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tMat</span>:<span class="ActionScriptDefault_Text">b2Mat22</span>;
        
        <span class="ActionScriptComment">//b2Vec2 s1 = m_ground-&gt;m_xf.position + m_groundAnchor1;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s1X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s1Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptComment">//b2Vec2 s2 = m_ground-&gt;m_xf.position + m_groundAnchor2;
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s2X</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s2Y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_ground</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m_groundAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        
        <span class="ActionScriptComment">// temp vars
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r1X</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r1Y</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r2X</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r2Y</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p1X</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p1Y</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p2X</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p2Y</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">length1</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">length2</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">C</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">impulse</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldImpulse</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldLimitPositionImpulse</span>:<span class="ActionScriptDefault_Text">Number</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tX</span>:<span class="ActionScriptDefault_Text">Number</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">linearError</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0.0;
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_state</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//b2Vec2 r1 = b2Mul(bA-&gt;m_xf.R, m_localAnchor1 - bA-&gt;GetLocalCenter());
</span>            <span class="ActionScriptDefault_Text">tMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
            <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptDefault_Text">tX</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tX</span>;
            <span class="ActionScriptComment">//b2Vec2 r2 = b2Mul(bB-&gt;m_xf.R, m_localAnchor2 - bB-&gt;GetLocalCenter());
</span>            <span class="ActionScriptDefault_Text">tMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
            <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptDefault_Text">tX</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tX</span>;
            
            <span class="ActionScriptComment">//b2Vec2 p1 = bA-&gt;m_sweep.c + r1;
</span>            <span class="ActionScriptDefault_Text">p1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r1X</span>;
            <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r1Y</span>;
            <span class="ActionScriptComment">//b2Vec2 p2 = bB-&gt;m_sweep.c + r2;
</span>            <span class="ActionScriptDefault_Text">p2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r2X</span>;
            <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r2Y</span>;
            
            <span class="ActionScriptComment">// Get the pulley axes.
</span>            <span class="ActionScriptComment">//m_u1 = p1 - s1;
</span>            <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p1X</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s1X</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//m_u2 = p2 - s2;
</span>            <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p2X</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s2X</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">length2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//m_u1 *= 1.0f / length1;
</span>                <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Multiply</span><span class="ActionScriptBracket/Brace">(</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetZero</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length2</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//m_u2 *= 1.0f / length2;
</span>                <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Multiply</span><span class="ActionScriptBracket/Brace">(</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">length2</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetZero</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_constant</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">length2</span>;
            <span class="ActionScriptDefault_Text">linearError</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">linearError</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">C</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Clamp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_maxLinearCorrection</span><span class="ActionScriptOperator">,</span> 0.0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_pulleyMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">C</span>;
            
            <span class="ActionScriptDefault_Text">p1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptDefault_Text">p2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_ratio</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p1X</span>;
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p1Y</span>;
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">a</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p1X</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p2X</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p2Y</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">a</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p2X</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SynchronizeTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SynchronizeTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_limitState1</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//b2Vec2 r1 = b2Mul(bA-&gt;m_xf.R, m_localAnchor1 - bA-&gt;GetLocalCenter());
</span>            <span class="ActionScriptDefault_Text">tMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
            <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptDefault_Text">tX</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tX</span>;
            <span class="ActionScriptComment">//b2Vec2 p1 = bA-&gt;m_sweep.c + r1;
</span>            <span class="ActionScriptDefault_Text">p1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r1X</span>;
            <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r1Y</span>;
            
            <span class="ActionScriptComment">//m_u1 = p1 - s1;
</span>            <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p1X</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s1X</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s1Y</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length1</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//m_u1 *= 1.0 / length1;
</span>                <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">length1</span>;
                <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">length1</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetZero</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_maxLength1</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">length1</span>;
            <span class="ActionScriptDefault_Text">linearError</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">linearError</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">C</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Clamp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_maxLinearCorrection</span><span class="ActionScriptOperator">,</span> 0.0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_limitMass1</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">C</span>;
            
            <span class="ActionScriptComment">//P1 = -impulse * m_u1;
</span>            <span class="ActionScriptDefault_Text">p1X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p1X</span>;
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p1Y</span>;
            <span class="ActionScriptComment">//bA.m_rotation += bA.m_invI * b2Cross(r1, P1);
</span>            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">a</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r1X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p1Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r1Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p1X</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SynchronizeTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_limitState2</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">e_atUpperLimit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//b2Vec2 r2 = b2Mul(bB-&gt;m_xf.R, m_localAnchor2 - bB-&gt;GetLocalCenter());
</span>            <span class="ActionScriptDefault_Text">tMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
            <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">localCenter</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptDefault_Text">tX</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tMat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">r2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tX</span>;
            <span class="ActionScriptComment">//b2Vec2 p2 = bB-&gt;m_position + r2;
</span>            <span class="ActionScriptDefault_Text">p2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r2X</span>;
            <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r2Y</span>;
            
            <span class="ActionScriptComment">//m_u2 = p2 - s2;
</span>            <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p2X</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s2X</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s2Y</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">length2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">length2</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//m_u2 *= 1.0 / length2;
</span>                <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">length2</span>;
                <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">length2</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetZero</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_maxLength2</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">length2</span>;
            <span class="ActionScriptDefault_Text">linearError</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">linearError</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">C</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Clamp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">C</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_maxLinearCorrection</span><span class="ActionScriptOperator">,</span> 0.0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">m_limitMass2</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">C</span>;
            
            <span class="ActionScriptComment">//P2 = -impulse * m_u2;
</span>            <span class="ActionScriptDefault_Text">p2X</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">impulse</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">m_u2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
            
            <span class="ActionScriptComment">//bB.m_sweep.c += bB.m_invMass * P2;
</span>            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p2X</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invMass</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p2Y</span>;
            <span class="ActionScriptComment">//bB.m_sweep.a += bB.m_invI * b2Cross(r2, P2);
</span>            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">a</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_invI</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r2X</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p2Y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r2Y</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p2X</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SynchronizeTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">linearError</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    

    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_ground</span>:<span class="ActionScriptDefault_Text">b2Body</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_groundAnchor1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_groundAnchor2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_localAnchor1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_localAnchor2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_u1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_u2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_constant</span>:<span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_ratio</span>:<span class="ActionScriptDefault_Text">Number</span>;
    
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_maxLength1</span>:<span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_maxLength2</span>:<span class="ActionScriptDefault_Text">Number</span>;

    <span class="ActionScriptComment">// Effective masses
</span>    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_pulleyMass</span>:<span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_limitMass1</span>:<span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_limitMass2</span>:<span class="ActionScriptDefault_Text">Number</span>;

    <span class="ActionScriptComment">// Impulses for accumulation/warm starting.
</span>    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_impulse</span>:<span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_limitImpulse1</span>:<span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_limitImpulse2</span>:<span class="ActionScriptDefault_Text">Number</span>;

    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_state</span>:<span class="ActionScriptDefault_Text">int</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_limitState1</span>:<span class="ActionScriptDefault_Text">int</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_limitState2</span>:<span class="ActionScriptDefault_Text">int</span>;
    
    <span class="ActionScriptComment">// static
</span>    <span class="ActionScriptReserved">static</span> <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">b2_minPulleyLength</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 2.0;
<span class="ActionScriptBracket/Brace">}</span>;
    
    
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
