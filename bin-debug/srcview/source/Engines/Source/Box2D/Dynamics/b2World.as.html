<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>b2World.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/*
* Copyright (c) 2006-2007 Erin Catto http://www.gphysics.com
*
* This software is provided 'as-is', without any express or implied
* warranty.  In no event will the authors be held liable for any damages
* arising from the use of this software.
* Permission is granted to anyone to use this software for any purpose,
* including commercial applications, and to alter it and redistribute it
* freely, subject to the following restrictions:
* 1. The origin of this software must not be misrepresented; you must not
* claim that you wrote the original software. If you use this software
* in a product, an acknowledgment in the product documentation would be
* appreciated but is not required.
* 2. Altered source versions must be plainly marked as such, and must not be
* misrepresented as being the original software.
* 3. This notice may not be removed or altered from any source distribution.
*/</span>

<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dynamics</span><span class="ActionScriptBracket/Brace">{</span>

<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Collision</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Collision</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Shapes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dynamics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dynamics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Contacts</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dynamics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Controllers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2Controller</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dynamics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Controllers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2ControllerEdge</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dynamics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Joints</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;

<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">Box2D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2internal</span>;
<span class="ActionScriptReserved">use</span> <span class="ActionScriptReserved">namespace</span> <span class="ActionScriptDefault_Text">b2internal</span>;


<span class="ActionScriptASDoc">/**
* The world class manages all physics entities, dynamic simulation,
* and asynchronous queries. 
*/</span>
<span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">b2World</span>
<span class="ActionScriptBracket/Brace">{</span>
    
    <span class="ActionScriptComment">// Construct a world object.
</span>    <span class="ActionScriptASDoc">/**
    * @param gravity the world gravity vector.
    * @param doSleep improve performance by not simulating inactive bodies.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">b2World</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gravity</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">doSleep</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptDefault_Text">m_destructionListener</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">m_debugDraw</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        
        <span class="ActionScriptDefault_Text">m_bodyList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">m_contactList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">m_jointList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">m_controllerList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        
        <span class="ActionScriptDefault_Text">m_bodyCount</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptDefault_Text">m_contactCount</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptDefault_Text">m_jointCount</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptDefault_Text">m_controllerCount</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptDefault_Text">m_warmStarting</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptDefault_Text">m_continuousPhysics</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptDefault_Text">m_allowSleep</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">doSleep</span>;
        <span class="ActionScriptDefault_Text">m_gravity</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">gravity</span>;
        
        <span class="ActionScriptDefault_Text">m_inv_dt0</span> <span class="ActionScriptOperator">=</span> 0.0;
        
        <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_world</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bd</span>:<span class="ActionScriptDefault_Text">b2BodyDef</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2BodyDef</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">m_groundBody</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">CreateBody</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bd</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Destruct the world. All physics entities are destroyed and all heap memory is released.
    */</span>
    <span class="ActionScriptComment">//~b2World();
</span>
    <span class="ActionScriptASDoc">/**
    * Register a destruction listener.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SetDestructionListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">b2DestructionListener</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">m_destructionListener</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">listener</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Register a contact filter to provide specific control over collision.
    * Otherwise the default filter is used (b2_defaultFilter).
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SetContactFilter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">filter</span>:<span class="ActionScriptDefault_Text">b2ContactFilter</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactFilter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">filter</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Register a contact event listener
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SetContactListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">b2ContactListener</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactListener</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">listener</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Register a routine for debug drawing. The debug draw functions are called
    * inside the b2World::Step method, so make sure your renderer is ready to
    * consume draw commands when you call Step().
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SetDebugDraw</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">debugDraw</span>:<span class="ActionScriptDefault_Text">b2DebugDraw</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">m_debugDraw</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">debugDraw</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
     * Use the given object as a broadphase.
     * The old broadphase will not be cleanly emptied.
     * @warning It is not recommended you call this except immediately after constructing the world.
     * @warning This function is locked during callbacks.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SetBroadPhase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">broadPhase</span>:<span class="ActionScriptDefault_Text">IBroadPhase</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">oldBroadPhase</span>:<span class="ActionScriptDefault_Text">IBroadPhase</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span>;
        <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">broadPhase</span>;
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">b</span>; <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">f</span>:<span class="ActionScriptDefault_Text">b2Fixture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_fixtureList</span>; <span class="ActionScriptDefault_Text">f</span>; <span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_proxy</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CreateProxy</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">oldBroadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetFatAABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_proxy</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">f</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
    * Perform validation of internal data structures.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Validate</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Validate</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
    * Get the number of broad-phase proxies.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetProxyCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">int</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetProxyCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
    * Create a rigid body given a definition. No reference to the definition
    * is retained.
    * @warning This function is locked during callbacks.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">CreateBody</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span>:<span class="ActionScriptDefault_Text">b2BodyDef</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptComment">//b2Settings.b2Assert(m_lock == false);
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">IsLocked</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//void* mem = m_blockAllocator.Allocate(sizeof(b2Body));
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">// Add to world doubly linked list.
</span>        <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_bodyList</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_bodyList</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">m_bodyList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span>;
        <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">m_bodyCount</span>;
        
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">b</span>;
        
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Destroy a rigid body given a definition. No reference to the definition
    * is retained. This function is locked during callbacks.
    * @warning This automatically deletes all associated shapes and joints.
    * @warning This function is locked during callbacks.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DestroyBody</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptComment">//b2Settings.b2Assert(m_bodyCount &gt; 0);
</span>        <span class="ActionScriptComment">//b2Settings.b2Assert(m_lock == false);
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">IsLocked</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Delete the attached joints.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">jn</span>:<span class="ActionScriptDefault_Text">b2JointEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span>;
        <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jn</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">jn0</span>:<span class="ActionScriptDefault_Text">b2JointEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">jn</span>;
            <span class="ActionScriptDefault_Text">jn</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">jn</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_destructionListener</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">m_destructionListener</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SayGoodbyeJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jn0</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">DestroyJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jn0</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Detach controllers attached to this body
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">coe</span>:<span class="ActionScriptDefault_Text">b2ControllerEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_controllerList</span>;
        <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">coe</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">coe0</span>:<span class="ActionScriptDefault_Text">b2ControllerEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">coe</span>;
            <span class="ActionScriptDefault_Text">coe</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">coe</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextController</span>;
            <span class="ActionScriptDefault_Text">coe0</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RemoveBody</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Delete the attached contacts.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ce</span>:<span class="ActionScriptDefault_Text">b2ContactEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactList</span>;
        <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ce0</span>:<span class="ActionScriptDefault_Text">b2ContactEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ce</span>;
            <span class="ActionScriptDefault_Text">ce</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span>;
            <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Destroy</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ce0</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        
        <span class="ActionScriptComment">// Delete the attached fixtures. This destroys broad-phase
</span>        <span class="ActionScriptComment">// proxies.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">f</span>:<span class="ActionScriptDefault_Text">b2Fixture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_fixtureList</span>;
        <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">f</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">f0</span>:<span class="ActionScriptDefault_Text">b2Fixture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">f</span>;
            <span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_destructionListener</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">m_destructionListener</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SayGoodbyeFixture</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">f0</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">f0</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DestroyProxy</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">f0</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Destroy</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//f0-&gt;~b2Fixture();
</span>            <span class="ActionScriptComment">//m_blockAllocator.Free(f0, sizeof(b2Fixture));
</span>            
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_fixtureList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_fixtureCount</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptComment">// Remove world body list.
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">m_bodyList</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_bodyList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptOperator">--</span><span class="ActionScriptDefault_Text">m_bodyCount</span>;
        <span class="ActionScriptComment">//b-&gt;~b2Body();
</span>        <span class="ActionScriptComment">//m_blockAllocator.Free(b, sizeof(b2Body));
</span>        
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Create a joint to constrain bodies together. No reference to the definition
    * is retained. This may cause the connected bodies to cease colliding.
    * @warning This function is locked during callbacks.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">CreateJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span>:<span class="ActionScriptDefault_Text">b2JointDef</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptComment">//b2Settings.b2Assert(m_lock == false);
</span>        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">b2Joint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Create</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">// Connect to the world list.
</span>        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_jointList</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">m_jointList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span>;
        <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">m_jointCount</span>;
        
        <span class="ActionScriptComment">// Connect to the bodies' doubly linked lists.
</span>        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">other</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyB</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span>;
        
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">other</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyA</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bodyA</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bodyA</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bodyB</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bodyB</span>;
        
        <span class="ActionScriptComment">// If the joint prevents collisions, then flag any contacts for filtering.
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">def</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">collideConnected</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">edge</span>:<span class="ActionScriptDefault_Text">b2ContactEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetContactList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">other</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">bodyA</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Flag the contact for filtering at the next time step (where either
</span>                    <span class="ActionScriptComment">// body is awake).
</span>                    <span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlagForFiltering</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptDefault_Text">edge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Note: creating a joint doesn't wake the bodies.
</span>        
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">j</span>;
        
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Destroy a joint. This may cause the connected bodies to begin colliding.
    * @warning This function is locked during callbacks.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DestroyJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptComment">//b2Settings.b2Assert(m_lock == false);
</span>        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">collideConnected</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_collideConnected</span>;
        
        <span class="ActionScriptComment">// Remove from the doubly linked list.
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_jointList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Disconnect from island graph.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bodyA</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyA</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bodyB</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyB</span>;
        
        <span class="ActionScriptComment">// Wake up connected bodies.
</span>        <span class="ActionScriptDefault_Text">bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">// Remove from body 1.
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">bodyA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        
        <span class="ActionScriptComment">// Remove from body 2
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_edgeB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        
        <span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Destroy</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">//b2Settings.b2Assert(m_jointCount &gt; 0);
</span>        <span class="ActionScriptOperator">--</span><span class="ActionScriptDefault_Text">m_jointCount</span>;
        
        <span class="ActionScriptComment">// If the joint prevents collisions, then flag any contacts for filtering.
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">collideConnected</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">edge</span>:<span class="ActionScriptDefault_Text">b2ContactEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bodyB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetContactList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">other</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">bodyA</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Flag the contact for filtering at the next time step (where either
</span>                    <span class="ActionScriptComment">// body is awake).
</span>                    <span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlagForFiltering</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptDefault_Text">edge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
     * Add a controller to the world list
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">AddController</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">b2Controller</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">b2Controller</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_controllerList</span>;
        <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">m_controllerList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span>;
        
        <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_world</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>;
        
        <span class="ActionScriptDefault_Text">m_controllerCount</span><span class="ActionScriptOperator">++</span>;
        
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">c</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RemoveController</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">b2Controller</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//TODO: Remove bodies from controller
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_controllerList</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">m_controllerList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
            
        <span class="ActionScriptDefault_Text">m_controllerCount</span><span class="ActionScriptOperator">--</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">CreateController</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">controller</span>:<span class="ActionScriptDefault_Text">b2Controller</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">b2Controller</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_world</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Controller can only be a member of one world"</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_controllerList</span>;
        <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_controllerList</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">m_controllerList</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">controller</span>;
        <span class="ActionScriptDefault_Text">m_controllerList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">controller</span>;
        <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">m_controllerCount</span>;
        
        <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_world</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>;
        
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">controller</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DestroyController</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">controller</span>:<span class="ActionScriptDefault_Text">b2Controller</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//b2Settings.b2Assert(m_controllerCount &gt; 0);
</span>        <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Clear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_prev</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">controller</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">m_controllerList</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">m_controllerList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span>;
        <span class="ActionScriptOperator">--</span><span class="ActionScriptDefault_Text">m_controllerCount</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
    * Enable/disable warm starting. For testing.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SetWarmStarting</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flag</span>: <span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">m_warmStarting</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flag</span>; <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Enable/disable continuous physics. For testing.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SetContinuousPhysics</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flag</span>: <span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">m_continuousPhysics</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flag</span>; <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
    * Get the number of bodies.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetBodyCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">int</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_bodyCount</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
    * Get the number of joints.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetJointCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">int</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_jointCount</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
    * Get the number of contacts (each may have 0 or more contact points).
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetContactCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">int</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_contactCount</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
    * Change the global gravity vector.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SetGravity</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gravity</span>: <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">)</span>: <span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">m_gravity</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">gravity</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Get the global gravity vector.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetGravity</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_gravity</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * The world provides a single static ground body with no collision shapes.
    * You can use this to simplify the creation of joints and static shapes.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetGroundBody</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_groundBody</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s_timestep2</span>:<span class="ActionScriptDefault_Text">b2TimeStep</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2TimeStep</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptASDoc">/**
    * Take a time step. This performs collision detection, integration,
    * and constraint solution.
    * @param timeStep the amount of time to simulate, this should not vary.
    * @param velocityIterations for the velocity constraint solver.
    * @param positionIterations for the position constraint solver.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Step</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dt</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">velocityIterations</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">positionIterations</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">e_newFixture</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FindNewContacts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">e_newFixture</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">e_locked</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">step</span>:<span class="ActionScriptDefault_Text">b2TimeStep</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s_timestep2</span>;
        <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dt</span>;
        <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">velocityIterations</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">velocityIterations</span>;
        <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">positionIterations</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">positionIterations</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">&gt;</span> 0.0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">inv_dt</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">dt</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">inv_dt</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dtRatio</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_inv_dt0</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">dt</span>;
        
        <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">warmStarting</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_warmStarting</span>;
        
        <span class="ActionScriptComment">// Update contacts.
</span>        <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Collide</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">// Integrate velocities, solve velocity constraints, and integrate positions.
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">&gt;</span> 0.0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">Solve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Handle TOI events.
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_continuousPhysics</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">&gt;</span> 0.0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">SolveTOI</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">&gt;</span> 0.0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">m_inv_dt0</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">inv_dt</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">e_locked</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
     * Call this after you are done with time steps to clear the forces. You normally
     * call this after each call to Step, unless you are performing sub-steps.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">ClearForces</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">body</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">body</span>; <span class="ActionScriptDefault_Text">body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_force</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetZero</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_torque</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s_xf</span>:<span class="ActionScriptDefault_Text">b2Transform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Transform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptASDoc">/**
     * Call this to draw shapes and other debug draw data.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DrawDebugData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_debugDraw</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sprite</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">graphics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flags</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetFlags</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">b2Body</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">f</span>:<span class="ActionScriptDefault_Text">b2Fixture</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">b2Shape</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">b2Joint</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bp</span>:<span class="ActionScriptDefault_Text">IBroadPhase</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">invQ</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xf</span>:<span class="ActionScriptDefault_Text">b2Transform</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b1</span>:<span class="ActionScriptDefault_Text">b2AABB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2AABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b2</span>:<span class="ActionScriptDefault_Text">b2AABB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2AABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vs</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
        
        <span class="ActionScriptComment">// Store color here and reuse, to reduce allocations
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">b2Color</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Color</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptBracket/Brace">)</span>;
            
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2DebugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_shapeBit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">b</span>; <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">xf</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetFixtureList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptDefault_Text">f</span>; <span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsActive</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span>0.5<span class="ActionScriptOperator">,</span> 0.5<span class="ActionScriptOperator">,</span> 0.3<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">DrawShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_staticBody</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span>0.5<span class="ActionScriptOperator">,</span> 0.9<span class="ActionScriptOperator">,</span> 0.5<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">DrawShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_kinematicBody</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span>0.5<span class="ActionScriptOperator">,</span> 0.5<span class="ActionScriptOperator">,</span> 0.9<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">DrawShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span>0.6<span class="ActionScriptOperator">,</span> 0.6<span class="ActionScriptOperator">,</span> 0.6<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">DrawShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span>0.9<span class="ActionScriptOperator">,</span> 0.7<span class="ActionScriptOperator">,</span> 0.7<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">DrawShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2DebugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_jointBit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_jointList</span>; <span class="ActionScriptDefault_Text">j</span>; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">DrawJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2DebugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_controllerBit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">b2Controller</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_controllerList</span>; <span class="ActionScriptDefault_Text">c</span>; <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Draw</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2DebugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_pairBit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span>0.3<span class="ActionScriptOperator">,</span> 0.9<span class="ActionScriptOperator">,</span> 0.9<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">contact</span>:<span class="ActionScriptDefault_Text">b2Contact</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactList</span>; <span class="ActionScriptDefault_Text">contact</span>; <span class="ActionScriptDefault_Text">contact</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetNext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fixtureA</span>:<span class="ActionScriptDefault_Text">b2Fixture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetFixtureA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fixtureB</span>:<span class="ActionScriptDefault_Text">b2Fixture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetFixtureB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cA</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fixtureA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetAABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetCenter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cB</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fixtureB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetAABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetCenter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cA</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cB</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2DebugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_aabbBit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">bp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span>;
            
            <span class="ActionScriptDefault_Text">vs</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">b</span>; <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetNext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsActive</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetFixtureList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptDefault_Text">f</span>; <span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetNext</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">aabb</span>:<span class="ActionScriptDefault_Text">b2AABB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bp</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetFatAABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_proxy</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">vs</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lowerBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lowerBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">vs</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">upperBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lowerBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">vs</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">upperBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">upperBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">vs</span><span class="ActionScriptBracket/Brace">[</span>3<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lowerBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">upperBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawPolygon</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vs</span><span class="ActionScriptOperator">,</span> 4<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2DebugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_centerOfMassBit</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">b</span>; <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">xf</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s_xf</span>;
                <span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span>;
                <span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetWorldCenter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Query the world for all fixtures that potentially overlap the
     * provided AABB.
     * @param callback a user implemented callback class. It should match signature
     * &lt;code&gt;function Callback(fixture:b2Fixture):Boolean&lt;/code&gt;
     * Return true to continue to the next fixture.
     * @param aabb the query box.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">QueryAABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">callback</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">aabb</span>:<span class="ActionScriptDefault_Text">b2AABB</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">broadPhase</span>:<span class="ActionScriptDefault_Text">IBroadPhase</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span>;
        <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">WorldQueryWrapper</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">proxy</span>:<span class="ActionScriptOperator">*</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">callback</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetUserData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">proxy</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Query</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">WorldQueryWrapper</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptASDoc">/**
     * Query the world for all fixtures that precisely overlap the
     * provided transformed shape.
     * @param callback a user implemented callback class. It should match signature
     * &lt;code&gt;function Callback(fixture:b2Fixture):Boolean&lt;/code&gt;
     * Return true to continue to the next fixture.
     * @asonly
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">QueryShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">callback</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">shape</span>:<span class="ActionScriptDefault_Text">b2Shape</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">transform</span>:<span class="ActionScriptDefault_Text">b2Transform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">transform</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">transform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Transform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetIdentity</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">broadPhase</span>:<span class="ActionScriptDefault_Text">IBroadPhase</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span>;
        <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">WorldQueryWrapper</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">proxy</span>:<span class="ActionScriptOperator">*</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fixture</span>:<span class="ActionScriptDefault_Text">b2Fixture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetUserData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">proxy</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">b2Fixture</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b2Shape</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TestOverlap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">shape</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fixture</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fixture</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetBody</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">callback</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fixture</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">aabb</span>:<span class="ActionScriptDefault_Text">b2AABB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2AABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">shape</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ComputeAABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Query</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">WorldQueryWrapper</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
     * Query the world for all fixtures that contain a point.
     * @param callback a user implemented callback class. It should match signature
     * &lt;code&gt;function Callback(fixture:b2Fixture):Boolean&lt;/code&gt;
     * Return true to continue to the next fixture.
     * @asonly
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">QueryPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">callback</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">broadPhase</span>:<span class="ActionScriptDefault_Text">IBroadPhase</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span>;
        <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">WorldQueryWrapper</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">proxy</span>:<span class="ActionScriptOperator">*</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fixture</span>:<span class="ActionScriptDefault_Text">b2Fixture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetUserData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">proxy</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">b2Fixture</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fixture</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TestPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">callback</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fixture</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptComment">// Make a small box.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">aabb</span>:<span class="ActionScriptDefault_Text">b2AABB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2AABB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lowerBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">upperBound</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_linearSlop</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Query</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">WorldQueryWrapper</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">aabb</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
     * Ray-cast the world for all fixtures in the path of the ray. Your callback
     * Controls whether you get the closest point, any point, or n-points
     * The ray-cast ignores shapes that contain the starting point
     * @param callback A callback function which must be of signature:
     * &lt;code&gt;function Callback(fixture:b2Fixture,    // The fixture hit by the ray
     * point:b2Vec2,         // The point of initial intersection
     * normal:b2Vec2,        // The normal vector at the point of intersection
     * fraction:Number       // The fractional length along the ray of the intersection
     * ):Number
     * &lt;/code&gt;
     * Callback should return the new length of the ray as a fraction of the original length.
     * By returning 0, you immediately terminate.
     * By returning 1, you continue wiht the original ray.
     * By returning the current fraction, you proceed to find the closest point.
     * @param point1 the ray starting point
     * @param point2 the ray ending point
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RayCast</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">callback</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">broadPhase</span>:<span class="ActionScriptDefault_Text">IBroadPhase</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_broadPhase</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">output</span>:<span class="ActionScriptDefault_Text">b2RayCastOutput</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2RayCastOutput</span>;
        <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RayCastWrapper</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">input</span>:<span class="ActionScriptDefault_Text">b2RayCastInput</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">proxy</span>:<span class="ActionScriptOperator">*</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">userData</span>:<span class="ActionScriptOperator">*</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetUserData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">proxy</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fixture</span>:<span class="ActionScriptDefault_Text">b2Fixture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">userData</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">b2Fixture</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hit</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fixture</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RayCast</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">output</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hit</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fraction</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">output</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fraction</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">point</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">(</span>
                    <span class="ActionScriptBracket/Brace">(</span>1.0 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">fraction</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">point1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">fraction</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">point2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptBracket/Brace">(</span>1.0 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">fraction</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">point1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">fraction</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">point2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">callback</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fixture</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">output</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">normal</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fraction</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">input</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">maxFraction</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">input</span>:<span class="ActionScriptDefault_Text">b2RayCastInput</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2RayCastInput</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point2</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">broadPhase</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RayCast</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RayCastWrapper</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RayCastOne</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">b2Fixture</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">b2Fixture</span>;
        <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RayCastOneWrapper</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fixture</span>:<span class="ActionScriptDefault_Text">b2Fixture</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">normal</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fraction</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">result</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fixture</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">fraction</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">RayCast</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RayCastOneWrapper</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point2</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">result</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RayCastAll</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Fixture</span><span class="ActionScriptBracket/Brace">&gt;</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Fixture</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Fixture</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">RayCastAllWrapper</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fixture</span>:<span class="ActionScriptDefault_Text">b2Fixture</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">normal</span>:<span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fraction</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">result</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">result</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fixture</span>;
            <span class="ActionScriptReserved">return</span> 1;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">RayCast</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RayCastAllWrapper</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">point2</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">result</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Get the world body list. With the returned body, use b2Body::GetNext to get
    * the next body in the world list. A NULL body indicates the end of the list.
    * @return the head of the world body list.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetBodyList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_bodyList</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
    * Get the world joint list. With the returned joint, use b2Joint::GetNext to get
    * the next joint in the world list. A NULL joint indicates the end of the list.
    * @return the head of the world joint list.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetJointList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_jointList</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Get the world contact list. With the returned contact, use b2Contact::GetNext to get
     * the next contact in the world list. A NULL contact indicates the end of the list.
     * @return the head of the world contact list.
     * @warning contacts are 
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">GetContactList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">b2Contact</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m_contactList</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptASDoc">/**
     * Is the world locked (in the middle of a time step).
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">IsLocked</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">e_locked</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;</span> 0;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptComment">//--------------- Internals Below -------------------
</span>    <span class="ActionScriptComment">// Internal yet public to make life easier.
</span>
    <span class="ActionScriptComment">// Find islands, integrate and solve constraints, solve position constraints
</span>    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s_stack</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Solve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span>:<span class="ActionScriptDefault_Text">b2TimeStep</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">b2Body</span>;
        
        <span class="ActionScriptComment">// Step all controllers
</span>        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">controller</span>:<span class="ActionScriptDefault_Text">b2Controller</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_controllerList</span>;<span class="ActionScriptDefault_Text">controller</span>;<span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Step</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Size the island for the worst case.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">island</span>:<span class="ActionScriptDefault_Text">b2Island</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_island</span>;
        <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Initialize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_bodyCount</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_contactCount</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_jointCount</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactListener</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_contactSolver</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">// Clear all the island flags.
</span>        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">b</span>; <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">b2Contact</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactList</span>; <span class="ActionScriptDefault_Text">c</span>; <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">b2Joint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_jointList</span>; <span class="ActionScriptDefault_Text">j</span>; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_islandFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Build and simulate all awake islands.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">stackSize</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyCount</span>;
        <span class="ActionScriptComment">//b2Body** stack = (b2Body**)m_stackAllocator.Allocate(stackSize * sizeof(b2Body*));
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">stack</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s_stack</span>;
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">seed</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">seed</span>; <span class="ActionScriptDefault_Text">seed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">seed</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">seed</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">continue</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">seed</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">seed</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsActive</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">continue</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// The seed can be dynamic or kinematic.
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">seed</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_staticBody</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">continue</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Reset island and stack.
</span>            <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Clear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">stackCount</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">stackCount</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">seed</span>;
            <span class="ActionScriptDefault_Text">seed</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
            
            <span class="ActionScriptComment">// Perform a depth first search (DFS) on the constraint graph.
</span>            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">stackCount</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Grab the next body off the stack and add it to the island.
</span>                <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptOperator">--</span><span class="ActionScriptDefault_Text">stackCount</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptComment">//b2Assert(b.IsActive() == true);
</span>                <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AddBody</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// Make sure the body is awake.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// To keep islands as small as possible, we don't
</span>                <span class="ActionScriptComment">// propagate islands across static bodies.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_staticBody</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">other</span>:<span class="ActionScriptDefault_Text">b2Body</span>;
                <span class="ActionScriptComment">// Search all contacts connected to this body.
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ce</span>:<span class="ActionScriptDefault_Text">b2ContactEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactList</span>; <span class="ActionScriptDefault_Text">ce</span>; <span class="ActionScriptDefault_Text">ce</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Has this contact already been added to an island?
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">// Is this contact solid and touching?
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsSensor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">true</span> <span class="ActionScriptOperator">||</span>
                        <span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsEnabled</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptOperator">||</span>
                        <span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsTouching</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AddContact</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
                    
                    <span class="ActionScriptComment">//var other:b2Body = ce.other;
</span>                    <span class="ActionScriptDefault_Text">other</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ce</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">other</span>;
                    
                    <span class="ActionScriptComment">// Was the other body already added to this island?
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">//b2Settings.b2Assert(stackCount &lt; stackSize);
</span>                    <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">stackCount</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">other</span>;
                    <span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// Search all joints connect to this body.
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">jn</span>:<span class="ActionScriptDefault_Text">b2JointEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span>; <span class="ActionScriptDefault_Text">jn</span>; <span class="ActionScriptDefault_Text">jn</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">jn</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jn</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_islandFlag</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">other</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">jn</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">other</span>;
                    
                    <span class="ActionScriptComment">// Don't simulate joints connected to inactive bodies.
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsActive</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AddJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jn</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">jn</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_islandFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">//b2Settings.b2Assert(stackCount &lt; stackSize);
</span>                    <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">stackCount</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">other</span>;
                    <span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Solve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_gravity</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_allowSleep</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Post solve cleanup.
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyCount</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Allow static bodies to participate in other islands.
</span>                <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodies</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_staticBody</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//m_stackAllocator.Free(stack);
</span>        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;<span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">break</span>;
            <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Synchronize fixutres, check for out of range bodies.
</span>        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">b</span>; <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsActive</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">continue</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_staticBody</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">continue</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Update fixtures (for broad-phase).
</span>            <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SynchronizeFixtures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Look for new contacts.
</span>        <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FindNewContacts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s_backupA</span>:<span class="ActionScriptDefault_Text">b2Sweep</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Sweep</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s_backupB</span>:<span class="ActionScriptDefault_Text">b2Sweep</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Sweep</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s_timestep</span>:<span class="ActionScriptDefault_Text">b2TimeStep</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2TimeStep</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s_queue</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptComment">// Find TOI contacts and solve them.
</span>    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SolveTOI</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">step</span>:<span class="ActionScriptDefault_Text">b2TimeStep</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">b2Body</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fA</span>:<span class="ActionScriptDefault_Text">b2Fixture</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fB</span>:<span class="ActionScriptDefault_Text">b2Fixture</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bA</span>:<span class="ActionScriptDefault_Text">b2Body</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bB</span>:<span class="ActionScriptDefault_Text">b2Body</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cEdge</span>:<span class="ActionScriptDefault_Text">b2ContactEdge</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">b2Joint</span>;
        
        <span class="ActionScriptComment">// Reserve an island and a queue for TOI island solution.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">island</span>:<span class="ActionScriptDefault_Text">b2Island</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_island</span>;
        <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Initialize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_bodyCount</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_maxTOIContactsPerIsland</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_maxTOIJointsPerIsland</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactListener</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">m_contactSolver</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">//Simple one pass queue
</span>        <span class="ActionScriptComment">//Relies on the fact that we're only making one pass
</span>        <span class="ActionScriptComment">//through and each body can only be pushed/popped one.
</span>        <span class="ActionScriptComment">//To push:
</span>        <span class="ActionScriptComment">//  queue[queueStart+queueSize++] = newElement;
</span>        <span class="ActionScriptComment">//To pop:
</span>        <span class="ActionScriptComment">//  poppedElement = queue[queueStart++];
</span>        <span class="ActionScriptComment">//  --queueSize;
</span>        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queue</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s_queue</span>;
        
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_bodyList</span>; <span class="ActionScriptDefault_Text">b</span>; <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
            <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t0</span> <span class="ActionScriptOperator">=</span> 0.0;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">b2Contact</span>;
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactList</span>; <span class="ActionScriptDefault_Text">c</span>; <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Invalidate TOI
</span>            <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_toiFlag</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_jointList</span>; <span class="ActionScriptDefault_Text">j</span>; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_islandFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">// Find TOI events and solve them.
</span>        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span>;;<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// Find the first TOI.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">minContact</span>:<span class="ActionScriptDefault_Text">b2Contact</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">minTOI</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1.0;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m_contactList</span>; <span class="ActionScriptDefault_Text">c</span>; <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_next</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Can this contact generate a solid TOI contact?
</span>                 <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsSensor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">true</span> <span class="ActionScriptOperator">||</span>
                    <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsEnabled</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptOperator">||</span>
                    <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsContinuous</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// TODO_ERIN keep a counter on the contact, only respond to M TOIs per contact.
</span>                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">toi</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1.0;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_toiFlag</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// This contact has a valid cached TOI.
</span>                    <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_toi</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Compute the TOI for this contact.
</span>                    <span class="ActionScriptDefault_Text">fA</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_fixtureA</span>;
                    <span class="ActionScriptDefault_Text">fB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_fixtureB</span>;
                    <span class="ActionScriptDefault_Text">bA</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_body</span>;
                    <span class="ActionScriptDefault_Text">bB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_body</span>;
                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_dynamicBody</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span>
                        <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_dynamicBody</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">// Put the sweeps onto the same time interval.
</span>                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t0</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t0</span>;
                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t0</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t0</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">t0</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t0</span>;
                        <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Advance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t0</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t0</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t0</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">t0</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t0</span>;
                        <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Advance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t0</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">//b2Settings.b2Assert(t0 &lt; 1.0f);
</span>                    
                    <span class="ActionScriptComment">// Compute the time of impact.
</span>                    <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ComputeTOI</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">b2Settings</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2Assert</span><span class="ActionScriptBracket/Brace">(</span>0.0 <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">&lt;=</span> 1.0<span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptComment">// If the TOI is in range ...
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">&gt;</span> 0.0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">&lt;</span> 1.0<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// Interpolate on the actual range.
</span>                        <span class="ActionScriptComment">//toi = Math.min((1.0 - toi) * t0 + toi, 1.0);
</span>                        <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span>1.0 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">toi</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">t0</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">toi</span>;
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">&gt;</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">=</span> 1;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    
                    <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_toi</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">toi</span>;
                    <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_toiFlag</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MIN_VALUE</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">toi</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">minTOI</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// This is the minimum TOI found so far.
</span>                    <span class="ActionScriptDefault_Text">minContact</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span>;
                    <span class="ActionScriptDefault_Text">minTOI</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">toi</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minContact</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">||</span> 1.0 <span class="ActionScriptOperator">-</span> 100.0 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MIN_VALUE</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">minTOI</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// No more TOI events. Done!
</span>                <span class="ActionScriptReserved">break</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Advance the bodies to the TOI.
</span>            <span class="ActionScriptDefault_Text">fA</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">minContact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_fixtureA</span>;
            <span class="ActionScriptDefault_Text">fB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">minContact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_fixtureB</span>;
            <span class="ActionScriptDefault_Text">bA</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_body</span>;
            <span class="ActionScriptDefault_Text">bB</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_body</span>;
            <span class="ActionScriptDefault_Text">s_backupA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">s_backupB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Advance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minTOI</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Advance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minTOI</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// The TOI contact likely has some new contact points.
</span>            <span class="ActionScriptDefault_Text">minContact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Update</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactListener</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">minContact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_toiFlag</span>;
            
            <span class="ActionScriptComment">// Is the contact solid?
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minContact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsSensor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">true</span> <span class="ActionScriptOperator">||</span>
                <span class="ActionScriptDefault_Text">minContact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsEnabled</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Restore the sweeps
</span>                <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s_backupA</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_sweep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Set</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s_backupB</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">bA</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SynchronizeTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">bB</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SynchronizeTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">continue</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Did numerical issues prevent;,ontact pointjrom being generated
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minContact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsTouching</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Give up on this TOI
</span>                <span class="ActionScriptReserved">continue</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Build the TOI island. We need a dynamic seed.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">seed</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bA</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">seed</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_dynamicBody</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">seed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bB</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Reset island and queue.
</span>            <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Clear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queueStart</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;    <span class="ActionScriptComment">//start index for queue
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">queueSize</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;    <span class="ActionScriptComment">//elements in queue
</span>            <span class="ActionScriptDefault_Text">queue</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">queueStart</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">queueSize</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">seed</span>;
            <span class="ActionScriptDefault_Text">seed</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
            
            <span class="ActionScriptComment">// Perform a breadth first search (BFS) on the contact graph.
</span>            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">queueSize</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Grab the next body off the stack and add it to the island.
</span>                <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">queue</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">queueStart</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptOperator">--</span><span class="ActionScriptDefault_Text">queueSize</span>;
                
                <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AddBody</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// Make sure the body is awake.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// To keep islands as small as possible, we don't
</span>                <span class="ActionScriptComment">// propagate islands across static or kinematic bodies.
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_dynamicBody</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// Search all contacts connected to this body.
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactList</span>; <span class="ActionScriptDefault_Text">cEdge</span>; <span class="ActionScriptDefault_Text">cEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// Does the TOI island still have space for contacts?
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactCount</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactCapacity</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">// Has this contact already been added to an island?
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">// Skip sperate, sensor, or disabled contacts.
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsSensor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">true</span> <span class="ActionScriptOperator">||</span>
                        <span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsEnabled</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptOperator">||</span>
                        <span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsTouching</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AddContact</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
                    
                    <span class="ActionScriptComment">// Update other body.
</span>                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">other</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">other</span>;
                    
                    <span class="ActionScriptComment">// Was the other body already added to this island?
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">// Synchronize the connected body.
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_staticBody</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Advance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minTOI</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">//b2Settings.b2Assert(queueStart + queueSize &lt; queueCapacity);
</span>                    <span class="ActionScriptDefault_Text">queue</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">queueStart</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">queueSize</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">other</span>;
                    <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">queueSize</span>;
                    <span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">jEdge</span>:<span class="ActionScriptDefault_Text">b2JointEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointList</span>; <span class="ActionScriptDefault_Text">jEdge</span>; <span class="ActionScriptDefault_Text">jEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">jEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointCount</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointCapacity</span><span class="ActionScriptBracket/Brace">)</span> 
                        <span class="ActionScriptReserved">continue</span>;
                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_islandFlag</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptReserved">continue</span>;
                    
                    <span class="ActionScriptDefault_Text">other</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">jEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">other</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsActive</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AddJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">jEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_islandFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptReserved">continue</span>;
                        
                    <span class="ActionScriptComment">// Synchronize the connected body.
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_staticBody</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Advance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">minTOI</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">//b2Settings.b2Assert(queueStart + queueSize &lt; queueCapacity);
</span>                    <span class="ActionScriptDefault_Text">queue</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">queueStart</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">queueSize</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">other</span>;
                    <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">queueSize</span>;
                    <span class="ActionScriptDefault_Text">other</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">subStep</span>:<span class="ActionScriptDefault_Text">b2TimeStep</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s_timestep</span>;
            <span class="ActionScriptDefault_Text">subStep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">warmStarting</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">subStep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span>1.0 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">minTOI</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dt</span>;
            <span class="ActionScriptDefault_Text">subStep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">inv_dt</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">subStep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dt</span>;
            <span class="ActionScriptDefault_Text">subStep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dtRatio</span> <span class="ActionScriptOperator">=</span> 0.0;
            <span class="ActionScriptDefault_Text">subStep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">velocityIterations</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">velocityIterations</span>;
            <span class="ActionScriptDefault_Text">subStep</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">positionIterations</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">step</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">positionIterations</span>;
            
            <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SolveTOI</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">subStep</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptComment">// Post solve cleanup.
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodyCount</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Allow bodies to participate in future TOI islands.
</span>                <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_bodies</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IsAwake</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b2Body</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b2_dynamicBody</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// Update fixtures (for broad-phase).
</span>                <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SynchronizeFixtures</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// Invalidate all contact TOIs associated with this body. Some of these
</span>                <span class="ActionScriptComment">// may not be in the island because they were not touching.
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactList</span>; <span class="ActionScriptDefault_Text">cEdge</span>; <span class="ActionScriptDefault_Text">cEdge</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">cEdge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_toiFlag</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contactCount</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Allow contacts to participate in future TOI islands.
</span>                <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_contacts</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_flags</span> <span class="ActionScriptOperator">&amp;=</span> <span class="ActionScriptOperator">~</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_toiFlag</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptDefault_Text">b2Contact</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_islandFlag</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_jointCount</span>;<span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Allow joints to participate in future TOI islands
</span>                <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">island</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_joints</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_islandFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// Commit fixture proxy movements to the broad-phase so that new contacts are created.
</span>            <span class="ActionScriptComment">// Also, some contacts can be destroyed.
</span>            <span class="ActionScriptDefault_Text">m_contactManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FindNewContacts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">//m_stackAllocator.Free(queue);
</span>    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s_jointColor</span>:<span class="ActionScriptDefault_Text">b2Color</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Color</span><span class="ActionScriptBracket/Brace">(</span>0.5<span class="ActionScriptOperator">,</span> 0.8<span class="ActionScriptOperator">,</span> 0.8<span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptComment">//
</span>    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DrawJoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">joint</span>:<span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b1</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetBodyA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b2</span>:<span class="ActionScriptDefault_Text">b2Body</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetBodyB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xf1</span>:<span class="ActionScriptDefault_Text">b2Transform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xf2</span>:<span class="ActionScriptDefault_Text">b2Transform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_xf</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">xf1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">xf2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetAnchorA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetAnchorB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        
        <span class="ActionScriptComment">//b2Color color(0.5f, 0.8f, 0.8f);
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">b2Color</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s_jointColor</span>;
        
        <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_type</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_distanceJoint</span>:
            <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">break</span>;
        
        <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_pulleyJoint</span>:
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pulley</span>:<span class="ActionScriptDefault_Text">b2PulleyJoint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">joint</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">b2PulleyJoint</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s1</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pulley</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetGroundAnchorA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s2</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pulley</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetGroundAnchorB</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">s2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">break</span>;
        
        <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">b2Joint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_mouseJoint</span>:
            <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">break</span>;
        
        <span class="ActionScriptReserved">default</span>:
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b1</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">m_groundBody</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b2</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">m_groundBody</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">p2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DrawShape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">shape</span>:<span class="ActionScriptDefault_Text">b2Shape</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xf</span>:<span class="ActionScriptDefault_Text">b2Transform</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">b2Color</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">shape</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_type</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">b2Shape</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_circleShape</span>:
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">circle</span>:<span class="ActionScriptDefault_Text">b2CircleShape</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">shape</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">b2CircleShape</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">center</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MulX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">circle</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_p</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">radius</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">circle</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">m_radius</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">axis</span>:<span class="ActionScriptDefault_Text">b2Vec2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">R</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">col1</span>;
                
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSolidCircle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">center</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">radius</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">axis</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">break</span>;
        
        <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">b2Shape</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_polygonShape</span>:
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">poly</span>:<span class="ActionScriptDefault_Text">b2PolygonShape</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">shape</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">b2PolygonShape</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vertexCount</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">poly</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetVertexCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">localVertices</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">poly</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetVertices</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vertices</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">b2Vec2</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vertexCount</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">vertexCount</span>; <span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MulX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">localVertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSolidPolygon</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">vertexCount</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">break</span>;
        
        <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">b2Shape</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">e_edgeShape</span>:
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">edge</span>: <span class="ActionScriptDefault_Text">b2EdgeShape</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">shape</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">b2EdgeShape</span>;
                
                <span class="ActionScriptDefault_Text">m_debugDraw</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DrawSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MulX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetVertex1</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">b2Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MulX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xf</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">edge</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetVertex2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">break</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_flags</span>:<span class="ActionScriptDefault_Text">int</span>;

    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_contactManager</span>:<span class="ActionScriptDefault_Text">b2ContactManager</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2ContactManager</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    
    <span class="ActionScriptComment">// These two are stored purely for efficiency purposes, they don't maintain
</span>    <span class="ActionScriptComment">// any data outside of a call to Step
</span>    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_contactSolver</span>:<span class="ActionScriptDefault_Text">b2ContactSolver</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2ContactSolver</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_island</span>:<span class="ActionScriptDefault_Text">b2Island</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">b2Island</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_bodyList</span>:<span class="ActionScriptDefault_Text">b2Body</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_jointList</span>:<span class="ActionScriptDefault_Text">b2Joint</span>;

    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_contactList</span>:<span class="ActionScriptDefault_Text">b2Contact</span>;

    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_bodyCount</span>:<span class="ActionScriptDefault_Text">int</span>;
    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_contactCount</span>:<span class="ActionScriptDefault_Text">int</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_jointCount</span>:<span class="ActionScriptDefault_Text">int</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_controllerList</span>:<span class="ActionScriptDefault_Text">b2Controller</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_controllerCount</span>:<span class="ActionScriptDefault_Text">int</span>;

    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_gravity</span>:<span class="ActionScriptDefault_Text">b2Vec2</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_allowSleep</span>:<span class="ActionScriptDefault_Text">Boolean</span>;

    <span class="ActionScriptDefault_Text">b2internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_groundBody</span>:<span class="ActionScriptDefault_Text">b2Body</span>;

    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_destructionListener</span>:<span class="ActionScriptDefault_Text">b2DestructionListener</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_debugDraw</span>:<span class="ActionScriptDefault_Text">b2DebugDraw</span>;

    <span class="ActionScriptComment">// This is used to compute the time step ratio to support a variable time step.
</span>    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_inv_dt0</span>:<span class="ActionScriptDefault_Text">Number</span>;

    <span class="ActionScriptComment">// This is for debugging the solver.
</span>    <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_warmStarting</span>:<span class="ActionScriptDefault_Text">Boolean</span>;

    <span class="ActionScriptComment">// This is for debugging the solver.
</span>    <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m_continuousPhysics</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
    
    <span class="ActionScriptComment">// m_flags
</span>    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">e_newFixture</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0x0001;
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">e_locked</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0x0002;
    
<span class="ActionScriptBracket/Brace">}</span>;



<span class="ActionScriptBracket/Brace">}</span>
</pre></body>
</html>
